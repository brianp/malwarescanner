package modules

import (
	"net/url"
	"encoding/json"
)

const (
  Ok ScanStatus = 1 << iota
  BadFile
)

type ScanStatus byte

func (s ScanStatus) String() string {
  var status string

  switch s {
    case Ok:
      status = "ok"
    case BadFile:
      status = "badfile"
  }

  return status
}

type ScanResult struct {
  Source *url.URL   `json:"source,string"`
  Result ScanStatus `json:"result"`
}

func (s ScanResult) MarshalJSON() ([]byte, error) {
  result := struct {
    Source string   `json:"source,string"`
    Result string   `json:"result,string"`
  }{
    Source: s.Source.String(),
    Result: s.Result.String(),
  }

  return json.Marshal(result)
}
