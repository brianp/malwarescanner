package modules

import (
	"os"

	"github.com/eaigner/clam"
)

func Scan(file1 *os.File) (ScanResult) {
	engine := clam.New()
	
	err := engine.Compile("cvd")
	if err != nil {
		panic(err)
	}
	
	file, err := os.Open(file1.Name())
	if err != nil {
		panic(err)
	}
	
	var status ScanStatus
	switch engine.Scan(file) {
	case nil:
		status = Ok
	default:
		status = BadFile
	}

	return ScanResult { Result: status }
}
